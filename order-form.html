<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIBZ | Website Order Form</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ==== VIBZ BRAND HEADER STYLES (From Homepage) ==== */
        :root {
            --accent: #FF6B00;
            --accent-light: rgba(255, 107, 0, 0.1);
            --dark: #121212;
            --darker: #0A0A0A;
            --light: #F8FAFC;
            --lighter: #FFFFFF;
            --border: #E5E7EB;
            --text: #374151;
            --text-light: #6B7280;
            --success: #10B981;
            --warning: #F59E0B;
            --radius: 12px;
            --radius-lg: 20px;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.05);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #fff7f1; /* Exact hero background color from homepage */
            color: var(--text);
            line-height: 1.5;
            min-height: 100vh;
        }

        /* ================= ORDER FORM HEADER (Branded like Homepage) ================= */
        .order-header {
            position: relative;
            width: 100%;
            padding: 1.5rem 6%;
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(255, 247, 241, 0.95); /* #fff7f1 with slight transparency */
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(238, 238, 238, 0.3);
            z-index: 100;
        }

        .order-logo {
            font-weight: 900;
            font-size: 2rem;
            color: var(--accent);
            letter-spacing: -1px;
            text-align: center;
        }

        .order-logo::after {
            content: ".";
            color: var(--dark);
            margin-left: 2px;
            font-weight: 900;
        }

        .tagline {
            color: var(--text-light);
            font-size: 1.1rem;
            font-weight: 500;
            text-align: center;
            margin-top: 0.5rem;
        }

        /* ================= ORDER FORM CONTAINER ================= */
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        /* ================= Progress Indicator ================= */
        .progress {
            display: flex;
            justify-content: space-between;
            margin: 40px 0;
            position: relative;
            counter-reset: step;
        }

        .progress::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--border);
            transform: translateY(-50%);
            z-index: 1;
        }

        .progress-step {
            position: relative;
            z-index: 2;
            background: var(--lighter);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-light);
            font-weight: 700;
            border: 2px solid var(--border);
            transition: all 0.3s ease;
        }

        .progress-step.active {
            background: var(--accent);
            border-color: var(--accent);
            color: white;
        }

        .progress-step.completed {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        .step-label {
            position: absolute;
            top: 45px;
            left: 50%;
            transform: translateX(-50%);
            white-space: nowrap;
            font-size: 0.8rem;
            color: var(--text-light);
            font-weight: 500;
        }

        .progress-step.active .step-label {
            color: var(--accent);
            font-weight: 600;
        }

        /* ================= Form Container ================= */
        .form-container {
            background: var(--lighter);
            border-radius: var(--radius-lg);
            padding: 40px;
            box-shadow: var(--shadow-lg);
            margin-bottom: 30px;
        }

        /* ================= Step Styles ================= */
        .step {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .step.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .step-header {
            margin-bottom: 30px;
            text-align: center;
        }

        .step-title {
            font-size: 2rem;
            font-weight: 800;
            color: var(--dark);
            margin-bottom: 10px;
            letter-spacing: -0.5px;
        }

        .step-subtitle {
            color: var(--text-light);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        /* ================= Plan Summary ================= */
        .plan-summary {
            background: var(--light);
            border-radius: var(--radius);
            padding: 30px;
            border-left: 4px solid var(--accent);
            margin-bottom: 30px;
        }

        .plan-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .plan-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark);
        }

        .plan-badge {
            background: var(--accent);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .plan-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .plan-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .plan-item i {
            color: var(--accent);
            font-size: 1.2rem;
        }

        /* ================= Form Elements ================= */
        .form-group {
            margin-bottom: 25px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }

        .form-label small {
            font-weight: normal;
            color: var(--text-light);
        }

        .form-control {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            transition: all 0.2s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px var(--accent-light);
        }

        textarea.form-control {
            min-height: 100px;
            resize: vertical;
        }

        select.form-control {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%236B7280' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
            padding-right: 40px;
        }

        /* ================= Page Setup ================= */
        .page-card {
            background: var(--light);
            border-radius: var(--radius);
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid var(--border);
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .page-number {
            font-weight: 800;
            color: var(--accent);
            font-size: 1.2rem;
        }

        .page-locked {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            color: var(--success);
            font-weight: 600;
            font-size: 0.9rem;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .grid-2 {
                grid-template-columns: 1fr;
            }
        }

        /* ================= Checkbox & Radio Groups ================= */
        .checkbox-group, .radio-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 10px;
        }

        .checkbox-item, .radio-item {
            flex: 1;
            min-width: 120px;
        }

        .checkbox-label, .radio-label {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 15px;
            background: var(--lighter);
            border: 2px solid var(--border);
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .checkbox-label:hover, .radio-label:hover {
            border-color: var(--accent);
        }

        input[type="checkbox"], input[type="radio"] {
            display: none;
        }

        input[type="checkbox"]:checked + .checkbox-label,
        input[type="radio"]:checked + .radio-label {
            background: var(--accent-light);
            border-color: var(--accent);
            color: var(--accent);
            font-weight: 600;
        }

        .checkbox-label i, .radio-label i {
            font-size: 1.1rem;
        }

        /* ================= AI Fallback ================= */
        .ai-fallback {
            background: var(--accent-light);
            border: 2px dashed var(--accent);
            border-radius: var(--radius);
            padding: 20px;
            margin-top: 15px;
            text-align: center;
        }

        .ai-toggle {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            cursor: pointer;
            color: var(--accent);
            font-weight: 600;
        }

        /* ================= File Upload ================= */
        .file-upload {
            border: 2px dashed var(--border);
            border-radius: var(--radius);
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .file-upload:hover {
            border-color: var(--accent);
            background: var(--accent-light);
        }

        .file-upload i {
            font-size: 2rem;
            color: var(--text-light);
            margin-bottom: 10px;
        }

        .file-upload input[type="file"] {
            display: none;
        }

        /* ================= Help Section ================= */
        .help-section {
            background: linear-gradient(135deg, var(--light) 0%, #f0f9ff 100%);
            border-radius: var(--radius);
            padding: 25px;
            margin-top: 30px;
            border: 1px solid var(--border);
        }

        .help-title {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--dark);
            margin-bottom: 15px;
            font-weight: 700;
        }

        /* ================= Buttons ================= */
        .button-group {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 1px solid var(--border);
        }

        .btn {
            padding: 14px 28px;
            border-radius: var(--radius);
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--accent);
            color: white;
        }

        .btn-primary:hover {
            background: #e55a00;
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .btn-secondary {
            background: var(--lighter);
            color: var(--text);
            border: 2px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--light);
            border-color: var(--text-light);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        /* ================= Review Summary ================= */
        .review-section {
            background: var(--light);
            border-radius: var(--radius);
            padding: 25px;
            margin-bottom: 20px;
        }

        .review-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            color: var(--dark);
            font-weight: 700;
        }

        .review-item {
            display: flex;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }

        .review-label {
            min-width: 150px;
            font-weight: 600;
            color: var(--text);
        }

        .review-value {
            flex: 1;
            color: var(--text-light);
        }

        .review-value.ai {
            color: var(--accent);
            font-style: italic;
        }

        /* ================= Success Message ================= */
        #successMessage {
            display: none;
            text-align: center;
            padding: 60px 20px;
        }

        /* ================= Responsive ================= */
        @media (max-width: 768px) {
            .container {
                padding: 0 10px;
            }
            
            .form-container {
                padding: 25px 20px;
            }
            
            .step-title {
                font-size: 1.7rem;
            }
            
            .button-group {
                flex-direction: column;
                gap: 15px;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
        }

        /* ================= Additional Branding (From Homepage) ================= */
        .order-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
        }

        body {
            padding-top: 100px;
        }
    </style>
</head>
<body>
    <!-- ================= VIBZ BRANDED HEADER (Like Homepage) ================= -->
    <div class="order-header">
        <div>
            <div class="order-logo">VIBZ</div>
            <div class="tagline">Website Order Form • Complete in 5 minutes</div>
        </div>
    </div>

    <div class="container">
        <!-- Progress Indicator -->
        <div class="progress">
            <div class="progress-step active" id="step1-indicator">
                <span>1</span>
                <div class="step-label">Plan</div>
            </div>
            <div class="progress-step" id="step2-indicator">
                <span>2</span>
                <div class="step-label">Pages</div>
            </div>
            <div class="progress-step" id="step3-indicator">
                <span>3</span>
                <div class="step-label">Features</div>
            </div>
            <div class="progress-step" id="step4-indicator">
                <span>4</span>
                <div class="step-label">Brand</div>
            </div>
            <div class="progress-step" id="step5-indicator">
                <span>5</span>
                <div class="step-label">Confidence</div>
            </div>
            <div class="progress-step" id="step6-indicator">
                <span>6</span>
                <div class="step-label">Review</div>
            </div>
        </div>

        <!-- Form Container -->
        <div class="form-container">
            <form id="websiteOrderForm">
                <!-- STEP 1: Plan Summary -->
                <div class="step active" id="step1">
                    <div class="step-header">
                        <h2 class="step-title">Your Website Plan</h2>
                        <p class="step-subtitle">Here's what you've purchased. You're all set to proceed!</p>
                    </div>

                    <div class="plan-summary">
                        <div class="plan-header">
                            <div class="plan-name" id="planName">Loading...</div>
                            <div class="plan-badge" id="planBadge">Plan</div>
                        </div>
                        <div class="plan-details" id="planDetails">
                            <!-- Filled by JavaScript -->
                        </div>
                    </div>

                    <div class="help-section">
                        <div class="help-title">
                            <i class="fas fa-info-circle"></i>
                            <span>Ready to start?</span>
                        </div>
                        <p>Your plan is locked and loaded. We'll use these parameters to build your perfect website. Click "Next" to begin setting up your pages.</p>
                    </div>
                </div>

                <!-- STEP 2: Page Setup -->
                <div class="step" id="step2">
                    <div class="step-header">
                        <h2 class="step-title">Set Up Your Pages</h2>
                        <p class="step-subtitle">Tell us about each page. Don't worry if you're unsure - we'll handle it!</p>
                    </div>

                    <div id="pagesContainer">
                        <!-- Pages will be generated here -->
                    </div>

                    <div class="help-section">
                        <div class="help-title">
                            <i class="fas fa-lightbulb"></i>
                            <span>Need help with pages?</span>
                        </div>
                        <p>For any page you're unsure about, simply check "I'm not sure - AI should fully design this page" and we'll create it based on industry best practices.</p>
                    </div>
                </div>

                <!-- STEP 3: Features -->
                <div class="step" id="step3">
                    <div class="step-header">
                        <h2 class="step-title">Included Features</h2>
                        <p class="step-subtitle">Everything you get with your plan</p>
                    </div>

                    <div class="plan-summary">
                        <div id="featuresList">
                            <!-- Filled by JavaScript -->
                        </div>
                    </div>

                    <div class="help-section">
                        <div class="help-title">
                            <i class="fas fa-check-circle"></i>
                            <span>All included</span>
                        </div>
                        <p>These features are automatically included with your plan. No need to configure anything - we'll implement them based on your business needs.</p>
                    </div>
                </div>

                <!-- STEP 4: Brand Info -->
                <div class="step" id="step4">
                    <div class="step-header">
                        <h2 class="step-title">Brand & Business Details</h2>
                        <p class="step-subtitle">Tell us about your business</p>
                    </div>

                    <div class="grid-2">
                        <div class="form-group">
                            <label class="form-label" for="businessName">Business Name *</label>
                            <input type="text" class="form-control" id="businessName" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="businessLocation">Location (City, Country) *</label>
                            <input type="text" class="form-control" id="businessLocation" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="businessDescription">Short Business Description *</label>
                        <textarea class="form-control" id="businessDescription" rows="3" required placeholder="What does your business do? Who do you serve?"></textarea>
                    </div>

                    <div class="grid-2">
                        <div class="form-group">
                            <label class="form-label" for="contactEmail">Contact Email *</label>
                            <input type="email" class="form-control" id="contactEmail" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="contactPhone">Phone Number</label>
                            <input type="tel" class="form-control" id="contactPhone">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Logo</label>
                        <div class="file-upload" id="logoUploadArea">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload your logo</p>
                            <p style="font-size: 0.9rem; color: var(--text-light); margin-top: 5px;">PNG, JPG or SVG • Max 5MB</p>
                            <input type="file" id="logoFile" accept=".png,.jpg,.jpeg,.svg">
                        </div>
                        <div class="ai-fallback" style="margin-top: 15px;">
                            <div class="ai-toggle" id="noLogoToggle">
                                <input type="checkbox" id="noLogoCheckbox">
                                <label for="noLogoCheckbox" style="cursor: pointer;">
                                    <i class="fas fa-magic"></i>
                                    I don't have a logo - create one for me
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Brand Style Preference <small>(Optional)</small></label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" id="styleModern" name="brandStyle" value="modern">
                                <label class="radio-label" for="styleModern">
                                    <i class="fas fa-palette"></i> Modern & Clean
                                </label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="stylePremium" name="brandStyle" value="premium">
                                <label class="radio-label" for="stylePremium">
                                    <i class="fas fa-gem"></i> Premium & Luxury
                                </label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="styleFriendly" name="brandStyle" value="friendly">
                                <label class="radio-label" for="styleFriendly">
                                    <i class="fas fa-heart"></i> Friendly & Warm
                                </label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="styleBold" name="brandStyle" value="bold">
                                <label class="radio-label" for="styleBold">
                                    <i class="fas fa-bolt"></i> Bold & Energetic
                                </label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="styleAI" name="brandStyle" value="ai" checked>
                                <label class="radio-label" for="styleAI">
                                    <i class="fas fa-robot"></i> AI Decides Best
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="help-section">
                        <div class="help-title">
                            <i class="fas fa-question-circle"></i>
                            <span>Don't have brand assets?</span>
                        </div>
                        <p>No problem! If you don't have a logo or brand colors, we'll create a professional brand identity for you based on your industry and preferences.</p>
                    </div>
                </div>

                <!-- STEP 5: Confidence Check -->
                <div class="step" id="step5">
                    <div class="step-header">
                        <h2 class="step-title">How Confident Are You?</h2>
                        <p class="step-subtitle">This helps us provide the right level of support</p>
                    </div>

                    <div class="plan-summary">
                        <div class="form-group">
                            <label class="form-label">How confident are you with the information you've provided?</label>
                            <div class="radio-group" style="flex-direction: column; gap: 10px;">
                                <div class="radio-item">
                                    <input type="radio" id="confidentHigh" name="confidence" value="very-confident">
                                    <label class="radio-label" for="confidentHigh" style="justify-content: flex-start;">
                                        <i class="fas fa-star"></i>
                                        <div>
                                            <strong>Very confident</strong><br>
                                            <small>I've provided complete, accurate information</small>
                                        </div>
                                    </label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" id="confidentMedium" name="confidence" value="somewhat-confident">
                                    <label class="radio-label" for="confidentMedium" style="justify-content: flex-start;">
                                        <i class="fas fa-check-circle"></i>
                                        <div>
                                            <strong>Somewhat confident</strong><br>
                                            <small>Most info is complete, but I might need some guidance</small>
                                        </div>
                                    </label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" id="confidentLow" name="confidence" value="need-help">
                                    <label class="radio-label" for="confidentLow" style="justify-content: flex-start;">
                                        <i class="fas fa-hands-helping"></i>
                                        <div>
                                            <strong>I need help with most of this</strong><br>
                                            <small>Please review everything and suggest improvements</small>
                                        </div>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="help-section">
                        <div class="help-title">
                            <i class="fas fa-comments"></i>
                            <span>We're here to help</span>
                        </div>
                        <p>Selecting "I need help" will trigger a personal consultation call before we start designing. We'll work together to perfect your requirements.</p>
                    </div>
                </div>

                <!-- STEP 6: Review & Submit -->
                <div class="step" id="step6">
                    <div class="step-header">
                        <h2 class="step-title">Review & Submit</h2>
                        <p class="step-subtitle">Check everything over. You can always refine details later!</p>
                    </div>

                    <div id="reviewContent">
                        <!-- Filled by JavaScript -->
                    </div>

                    <div class="help-section">
                        <div class="help-title">
                            <i class="fas fa-rocket"></i>
                            <span>What happens next?</span>
                        </div>
                        <p>After submission, you'll receive a confirmation email. Our design team will review your order and start working within 24 hours. We'll contact you if we need any clarifications.</p>
                    </div>
                </div>

                <!-- Navigation Buttons -->
                <div class="button-group">
                    <button type="button" class="btn btn-secondary" id="prevBtn" onclick="prevStep()">
                        <i class="fas fa-arrow-left"></i> Previous
                    </button>
                    <button type="button" class="btn btn-primary" id="nextBtn" onclick="nextStep()">
                        Next <i class="fas fa-arrow-right"></i>
                    </button>
                    <button type="submit" class="btn btn-primary" id="submitBtn" style="display: none;">
                        <i class="fas fa-paper-plane"></i> Submit Order
                    </button>
                </div>
            </form>
        </div>

        <!-- Success Message (Hidden by default) -->
        <div id="successMessage" style="display: none; text-align: center; padding: 60px 20px;">
            <div style="font-size: 4rem; color: var(--success); margin-bottom: 20px;">
                <i class="fas fa-check-circle"></i>
            </div>
            <h2 style="font-size: 2.5rem; margin-bottom: 20px; color: var(--dark);">Order Submitted Successfully!</h2>
            <p style="font-size: 1.2rem; color: var(--text); max-width: 600px; margin: 0 auto 40px;">
                Thank you! Your website order has been received. Our team will begin work immediately and contact you within 24 hours.
            </p>
            <div style="background: var(--light); padding: 30px; border-radius: var(--radius); max-width: 500px; margin: 0 auto;">
                <h3 style="margin-bottom: 15px;">What's Next?</h3>
                <ol style="text-align: left; color: var(--text);">
                    <li style="margin-bottom: 10px;">Check your email for order confirmation</li>
                    <li style="margin-bottom: 10px;">We'll review your requirements (1-2 days)</li>
                    <li style="margin-bottom: 10px;">First design mockups delivered</li>
                    <li>Project kickoff call scheduled</li>
                </ol>
            </div>
        </div>
    </div>



    <script>
    // ===================== CONFIGURATION =====================
    const PLANS = {
        standard: {
            name: "Standard Plan",
            pages: 5,
            revisions: 5,
            delivery: "10-15 days",
            support: "3 months",
            price: "£1,500",
            features: ["Mobile Responsive Design", "Basic SEO Setup", "Contact Form", "Social Media Integration", "Speed Optimization"]
        },
        premium: {
            name: "Premium Plan",
            pages: 15,
            revisions: 10,
            delivery: "25-30 days",
            support: "6 months",
            price: "£3,000",
            features: [
                "Mobile Responsive Design",
                "Advanced SEO Optimization",
                "Contact Form with Automation",
                "Social Media Integration",
                "Speed Optimization (95+ Score)",
                "Advanced Analytics",
                "Content Management System",
                "E-commerce Ready",
                "Custom Animations",
                "Priority Support"
            ]
        }
    };

    const PAGE_TYPES = [
        "About", "Services", "Contact", "Gallery", "Pricing",
        "Testimonials", "Blog", "FAQ", "Team", "Portfolio",
        "Booking", "Shop", "Resources", "Careers", "Custom"
    ];

    const PAGE_GOALS = [
        { id: "generate-leads", label: "Generate leads", icon: "fa-bullseye" },
        { id: "inform", label: "Inform visitors", icon: "fa-info-circle" },
        { id: "build-trust", label: "Build trust", icon: "fa-handshake" },
        { id: "showcase", label: "Showcase work", icon: "fa-images" },
        { id: "ai-decides", label: "AI decides best", icon: "fa-robot" }
    ];

    const PAGE_SECTIONS = [
        { id: "hero", label: "Hero Section", icon: "fa-star" },
        { id: "text-image", label: "Text + Image", icon: "fa-align-left" },
        { id: "gallery", label: "Gallery", icon: "fa-th" },
        { id: "testimonials", label: "Testimonials", icon: "fa-quote-right" },
        { id: "cta", label: "Call to Action", icon: "fa-phone-alt" },
        { id: "ai-sections", label: "AI decides sections", icon: "fa-magic" }
    ];

    const TONE_OPTIONS = [
        { id: "modern", label: "Modern", icon: "fa-palette" },
        { id: "premium", label: "Premium", icon: "fa-gem" },
        { id: "friendly", label: "Friendly", icon: "fa-heart" },
        { id: "bold", label: "Bold", icon: "fa-bolt" },
        { id: "ai-tone", label: "AI decides tone", icon: "fa-robot" }
    ];

    // ===================== STATE MANAGEMENT =====================
    let currentStep = 1;
    const totalSteps = 6;
    let plan = "standard"; // Will be updated from URL/localStorage
    let formData = {
        pages: [],
        brand: {},
        confidence: ""
    };
    
    // Data from barber funnel
    let funnelData = {};
    let selectedServices = [];
    let serviceCounts = {};

    // ===================== INITIALIZATION =====================
    document.addEventListener('DOMContentLoaded', function() {
        // Load data from barber funnel
        loadFunnelData();
        
        // Get plan from URL or localStorage
        const urlParams = new URLSearchParams(window.location.search);
        const planParam = urlParams.get('plan');
        const businessParam = urlParams.get('business');
        
        // Try to get from localStorage first (more complete data)
        try {
            const storedData = JSON.parse(localStorage.getItem('barberFunnelData') || '{}');
            const storedPlan = localStorage.getItem('selectedPlan') || '';
            const storedServices = JSON.parse(localStorage.getItem('selectedServices') || '[]');
            const storedCounts = JSON.parse(localStorage.getItem('serviceCounts') || '{}');
            
            if (storedData.businessName || storedPlan) {
                funnelData = storedData;
                selectedServices = storedServices;
                serviceCounts = storedCounts;
                
                // Determine plan from stored data
                if (storedPlan.includes('Premium') || storedData.planType === 'Premium') {
                    plan = 'premium';
                } else if (storedPlan.includes('Standard') || storedData.planType === 'Standard') {
                    plan = 'standard';
                } else if (planParam) {
                    plan = (planParam.toLowerCase() === 'premium') ? 'premium' : 'standard';
                }
                
                console.log('Loaded from localStorage:', { funnelData, selectedServices, serviceCounts, plan });
            }
        } catch (e) {
            console.error('Error loading localStorage:', e);
        }
        
        // Fallback to URL parameters
        if (!plan || plan === 'standard') {
            plan = (planParam && PLANS[planParam.toLowerCase()]) ? planParam.toLowerCase() : 'standard';
        }
        
        // Initialize form with loaded data
        initializePlan();
        updateProgress();
        setupEventListeners();
        prefillFormData();
    });

    // Load data from barber funnel
    function loadFunnelData() {
        try {
            // Get from localStorage
            funnelData = JSON.parse(localStorage.getItem('barberFunnelData') || '{}');
            selectedServices = JSON.parse(localStorage.getItem('selectedServices') || '[]');
            serviceCounts = JSON.parse(localStorage.getItem('serviceCounts') || '{}');
            
            console.log('Funnel data loaded:', funnelData);
            console.log('Selected services:', selectedServices);
            console.log('Service counts:', serviceCounts);
            
            // Clear localStorage after loading (optional)
            // localStorage.removeItem('barberFunnelData');
            // localStorage.removeItem('selectedServices');
            // localStorage.removeItem('serviceCounts');
            
        } catch (e) {
            console.error('Error loading funnel data:', e);
        }
    }

    // Pre-fill form with data from funnel
    function prefillFormData() {
        // Pre-fill business name if available
        if (funnelData.businessName) {
            const businessNameField = document.getElementById('businessName');
            if (businessNameField) {
                businessNameField.value = funnelData.businessName;
            }
        }
        
        // Update plan summary with selected services
        if (selectedServices.length > 0) {
            const planDetails = document.getElementById('planDetails');
            if (planDetails) {
                // Add services count to plan details
                const servicesHTML = `
                    <div class="plan-item">
                        <i class="fas fa-check-circle"></i>
                        <span>${selectedServices.length} Selected Services</span>
                    </div>
                    ${serviceCounts.standard > 0 ? `
                    <div class="plan-item">
                        <i class="fas fa-check" style="color: #4CAF50;"></i>
                        <span>${serviceCounts.standard} Standard Services</span>
                    </div>
                    ` : ''}
                    ${serviceCounts.premium > 0 ? `
                    <div class="plan-item">
                        <i class="fas fa-check" style="color: #2196F3;"></i>
                        <span>${serviceCounts.premium} Premium Services</span>
                    </div>
                    ` : ''}
                `;
                
                // Insert after existing plan items
                planDetails.insertAdjacentHTML('beforeend', servicesHTML);
            }
            
            // Update features list with selected services
            const featuresList = document.getElementById('featuresList');
            if (featuresList) {
                // Add selected services section
                const servicesSection = `
                    <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border);">
                        <h4 style="color: var(--accent); margin-bottom: 10px;">Your Selected Services:</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px;">
                            ${selectedServices.map(service => `
                                <div class="plan-item" style="background: var(--accent-light);">
                                    <i class="fas fa-check-circle" style="color: var(--accent);"></i>
                                    <span>${service}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                
                featuresList.insertAdjacentHTML('beforeend', servicesSection);
            }
        }
    }

// ===================== PLAN INITIALIZATION =====================
    function initializePlan() {
        const planData = PLANS[plan];
        
        // Get payment model from localStorage
        let paymentModel = '';
        try {
            paymentModel = localStorage.getItem('paymentModel') || '';
            const storedPlan = localStorage.getItem('selectedPlan') || '';
            
            // Extract payment model from stored plan if available
            if (storedPlan.includes('Monthly Support')) {
                paymentModel = 'Monthly Support';
            } else if (storedPlan.includes('Own Outright')) {
                paymentModel = 'Own Outright';
            }
        } catch (e) {
            console.error('Error loading payment model:', e);
        }
        
        // Format plan name
        let displayPlanName = planData.name;
        if (paymentModel) {
            displayPlanName = `${planData.name} - ${paymentModel}`;
        }
        
        // Update plan summary
        document.getElementById('planName').textContent = displayPlanName; // FIXED: Include payment model
        document.getElementById('planBadge').textContent = plan.toUpperCase();
        
        // Add payment model info if available
        let paymentInfo = '';
        if (paymentModel === 'Monthly Support') {
            paymentInfo = '<div class="plan-item"><i class="fas fa-calendar-alt"></i><span>Monthly Subscription</span></div>';
        } else if (paymentModel === 'Own Outright') {
            paymentInfo = '<div class="plan-item"><i class="fas fa-crown"></i><span>One-time Payment</span></div>';
        }
        
        const planDetails = document.getElementById('planDetails');
        planDetails.innerHTML = `
            <div class="plan-item">
                <i class="fas fa-file"></i>
                <span>Up to ${planData.pages} pages</span>
            </div>
            <div class="plan-item">
                <i class="fas fa-sync-alt"></i>
                <span>${planData.revisions} revisions per page</span>
            </div>
            <div class="plan-item">
                <i class="fas fa-shipping-fast"></i>
                <span>Delivery: ${planData.delivery}</span>
            </div>
            <div class="plan-item">
                <i class="fas fa-headset"></i>
                <span>${planData.support} support</span>
            </div>
            <div class="plan-item">
                <i class="fas fa-pound-sign"></i>
                <span>Price: ${planData.price}</span>
            </div>
            ${paymentInfo}
        `;
        
        // Update features list
        const featuresList = document.getElementById('featuresList');
        featuresList.innerHTML = planData.features.map(feature => `
            <div class="plan-item">
                <i class="fas fa-check-circle"></i>
                <span>${feature}</span>
            </div>
        `).join('');
        
        // Add selected services section if available
        if (selectedServices.length > 0) {
            const servicesSection = `
                <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border);">
                    <h4 style="color: var(--accent); margin-bottom: 10px;">Your Selected Services:</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px;">
                        ${selectedServices.map(service => `
                            <div class="plan-item" style="background: var(--accent-light);">
                                <i class="fas fa-check-circle" style="color: var(--accent);"></i>
                                <span>${service}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            featuresList.insertAdjacentHTML('beforeend', servicesSection);
        }
        
        // Initialize pages
        initializePages();
    }

    // ===================== PAGES MANAGEMENT =====================
    function initializePages() {
        const pagesContainer = document.getElementById('pagesContainer');
        const pageCount = PLANS[plan].pages;
        
        let pagesHTML = '';
        
        for (let i = 1; i <= pageCount; i++) {
            const isHomePage = i === 1;
            const pageName = isHomePage ? 'Home' : '';
            
            // Pre-fill page names based on selected services
            let suggestedPageName = '';
            if (i === 1) suggestedPageName = 'Home';
            else if (i === 2) suggestedPageName = 'Services';
            else if (i === 3) suggestedPageName = 'Gallery';
            else if (i === 4) suggestedPageName = 'About';
            else if (i === 5) suggestedPageName = 'Contact';
            
            pagesHTML += `
                <div class="page-card" data-page="${i}">
                    <div class="page-header">
                        <div class="page-number">Page ${i}</div>
                        ${isHomePage ? '<div class="page-locked"><i class="fas fa-lock"></i> Home Page (Required)</div>' : ''}
                    </div>
                    
                    <div class="grid-2">
                        <div class="form-group">
                            <label class="form-label">Page Name ${isHomePage ? '(Locked)' : ''}</label>
                            ${isHomePage ? 
                                `<input type="text" class="form-control" value="Home" readonly style="background: var(--light);">` :
                                `<select class="form-control page-type" data-page="${i}">
                                    <option value="">Select a page type...</option>
                                    ${PAGE_TYPES.map(type => `<option value="${type.toLowerCase()}" ${type === suggestedPageName ? 'selected' : ''}>${type}</option>`).join('')}
                                    <option value="custom">Custom (Specify below)</option>
                                </select>
                                <input type="text" class="form-control custom-page-name" data-page="${i}" 
                                       placeholder="Enter custom page name..." style="margin-top: 10px; display: none;" 
                                       value="${suggestedPageName && suggestedPageName !== 'Home' ? suggestedPageName : ''}">`
                            }
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Page Goal</label>
                            <div class="radio-group">
                                ${PAGE_GOALS.map(goal => `
                                    <div class="radio-item">
                                        <input type="radio" id="goal-${i}-${goal.id}" name="goal-${i}" value="${goal.id}" 
                                               ${goal.id === 'ai-decides' ? 'checked' : ''}>
                                        <label class="radio-label" for="goal-${i}-${goal.id}">
                                            <i class="fas ${goal.icon}"></i> ${goal.label}
                                        </label>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">
                            Main Instruction <small>(What should this page accomplish?)</small>
                        </label>
                        <textarea class="form-control page-instruction" data-page="${i}" 
                                  rows="3" placeholder="Describe what you want on this page... or simply write 'do it for me'"></textarea>
                    </div>
                    
                    <div class="grid-2">
                        <div class="form-group">
                            <label class="form-label">Tone & Style <small>(Optional)</small></label>
                            <div class="checkbox-group">
                                ${TONE_OPTIONS.map(tone => `
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="tone-${i}-${tone.id}" value="${tone.id}"
                                               ${tone.id === 'ai-tone' ? 'checked' : ''}>
                                        <label class="checkbox-label" for="tone-${i}-${tone.id}">
                                            <i class="fas ${tone.icon}"></i> ${tone.label}
                                        </label>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Sections to Include</label>
                            <div class="checkbox-group">
                                ${PAGE_SECTIONS.map(section => `
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="section-${i}-${section.id}" value="${section.id}"
                                               ${section.id === 'ai-sections' ? 'checked' : ''}>
                                        <label class="checkbox-label" for="section-${i}-${section.id}">
                                            <i class="fas ${section.icon}"></i> ${section.label}
                                        </label>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Images for this page <small>(Optional)</small></label>
                        <div class="file-upload page-image-upload" data-page="${i}">
                            <i class="fas fa-images"></i>
                            <p>Upload images for this page</p>
                            <p style="font-size: 0.9rem; color: var(--text-light); margin-top: 5px;">JPG, PNG • Max 10MB each</p>
                            <input type="file" class="page-images" data-page="${i}" multiple accept=".jpg,.jpeg,.png" style="display: none;">
                        </div>
                        <div class="ai-fallback" style="margin-top: 15px;">
                            <div class="ai-toggle">
                                <input type="checkbox" id="noImages-${i}" class="no-images-toggle" data-page="${i}">
                                <label for="noImages-${i}" style="cursor: pointer;">
                                    <i class="fas fa-image"></i>
                                    I don't have images - use professional placeholders
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    ${!isHomePage ? `
                    <div class="ai-fallback">
                        <div class="ai-toggle">
                            <input type="checkbox" id="aiOverride-${i}" class="ai-override-toggle" data-page="${i}">
                            <label for="aiOverride-${i}" style="cursor: pointer;">
                                <i class="fas fa-robot"></i>
                                I'm not sure - AI should fully design this page
                            </label>
                        </div>
                    </div>
                    ` : ''}
                </div>
            `;
        }
        
        pagesContainer.innerHTML = pagesHTML;
        
        // Set up page type change listeners
        document.querySelectorAll('.page-type').forEach(select => {
            select.addEventListener('change', function() {
                const pageNum = this.getAttribute('data-page');
                const customInput = document.querySelector(`.custom-page-name[data-page="${pageNum}"]`);
                if (this.value === 'custom') {
                    customInput.style.display = 'block';
                    customInput.required = true;
                } else {
                    customInput.style.display = 'none';
                    customInput.required = false;
                }
            });
            
            // Trigger change event for pre-selected values
            if (select.value === 'custom') {
                select.dispatchEvent(new Event('change'));
            }
        });
        
        // Set up file upload interactions
        document.querySelectorAll('.file-upload').forEach(upload => {
            upload.addEventListener('click', function() {
                const input = this.querySelector('input[type="file"]');
                if (input) input.click();
            });
        });
        
        document.getElementById('logoFile').addEventListener('change', function(e) {
            const noLogoCheckbox = document.getElementById('noLogoCheckbox');
            if (this.files.length > 0) {
                noLogoCheckbox.checked = false;
            }
        });
        
        document.getElementById('noLogoToggle').addEventListener('click', function(e) {
            if (e.target.tagName !== 'INPUT') {
                const checkbox = document.getElementById('noLogoCheckbox');
                checkbox.checked = !checkbox.checked;
                if (checkbox.checked) {
                    document.getElementById('logoFile').value = '';
                }
            }
        });
        
        // Set up AI override toggles
        document.querySelectorAll('.ai-override-toggle').forEach(toggle => {
            toggle.addEventListener('change', function() {
                const pageNum = this.getAttribute('data-page');
                const pageCard = document.querySelector(`.page-card[data-page="${pageNum}"]`);
                if (this.checked) {
                    // Disable all inputs in this page card
                    pageCard.querySelectorAll('input, select, textarea').forEach(input => {
                        if (input !== this) {
                            input.disabled = true;
                            input.style.opacity = '0.6';
                        }
                    });
                } else {
                    // Re-enable all inputs
                    pageCard.querySelectorAll('input, select, textarea').forEach(input => {
                        input.disabled = false;
                        input.style.opacity = '1';
                    });
                }
            });
        });
    }

    // ===================== STEP NAVIGATION =====================
    function updateProgress() {
        // Update progress indicators
        document.querySelectorAll('.progress-step').forEach((step, index) => {
            const stepNum = index + 1;
            step.classList.remove('active', 'completed');
            
            if (stepNum < currentStep) {
                step.classList.add('completed');
            } else if (stepNum === currentStep) {
                step.classList.add('active');
            }
        });
        
        // Update button visibility
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const submitBtn = document.getElementById('submitBtn');
        
        prevBtn.style.display = currentStep > 1 ? 'flex' : 'none';
        nextBtn.style.display = currentStep < totalSteps ? 'flex' : 'none';
        submitBtn.style.display = currentStep === totalSteps ? 'flex' : 'none';
        
        // Update step content
        document.querySelectorAll('.step').forEach((step, index) => {
            step.classList.remove('active');
            if (index + 1 === currentStep) {
                step.classList.add('active');
            }
        });
        
        // Update review if on last step
        if (currentStep === totalSteps) {
            generateReview();
        }
    }

    function nextStep() {
        // Validate current step before proceeding
        if (!validateCurrentStep()) {
            return;
        }
        
        // Save current step data
        saveStepData();
        
        if (currentStep < totalSteps) {
            currentStep++;
            updateProgress();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    }

    function prevStep() {
        if (currentStep > 1) {
            currentStep--;
            updateProgress();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    }

    function validateCurrentStep() {
        const currentStepEl = document.querySelector('.step.active');
        
        // Step 4 validation
        if (currentStep === 4) {
            const requiredFields = [
                'businessName',
                'businessLocation',
                'businessDescription',
                'contactEmail'
            ];
            
            for (const fieldId of requiredFields) {
                const field = document.getElementById(fieldId);
                if (!field.value.trim()) {
                    alert(`Please fill in the ${field.labels[0].textContent.toLowerCase()}`);
                    field.focus();
                    field.style.borderColor = 'var(--warning)';
                    setTimeout(() => field.style.borderColor = '', 2000);
                    return false;
                }
            }
            
            // Email validation
            const email = document.getElementById('contactEmail').value;
            if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                alert('Please enter a valid email address');
                document.getElementById('contactEmail').focus();
                return false;
            }
        }
        
        // Step 5 validation
        if (currentStep === 5) {
            const selectedConfidence = document.querySelector('input[name="confidence"]:checked');
            if (!selectedConfidence) {
                alert('Please select how confident you are with the information provided');
                return false;
            }
            formData.confidence = selectedConfidence.value;
        }
        
        return true;
    }

    function saveStepData() {
        if (currentStep === 4) {
            // Save brand data
            formData.brand = {
                name: document.getElementById('businessName').value,
                location: document.getElementById('businessLocation').value,
                description: document.getElementById('businessDescription').value,
                email: document.getElementById('contactEmail').value,
                phone: document.getElementById('contactPhone').value,
                hasLogo: !document.getElementById('noLogoCheckbox').checked,
                style: document.querySelector('input[name="brandStyle"]:checked')?.value || 'ai'
            };
        }
    }


        // ===================== REVIEW GENERATION =====================
    function generateReview() {
        const reviewContent = document.getElementById('reviewContent');
        const planData = PLANS[plan];
        
        // Get payment model
        let paymentModel = '';
        try {
            paymentModel = localStorage.getItem('paymentModel') || '';
            const storedPlan = localStorage.getItem('selectedPlan') || '';
            
            if (storedPlan.includes('Monthly Support')) {
                paymentModel = 'Monthly Support';
            } else if (storedPlan.includes('Own Outright')) {
                paymentModel = 'Own Outright';
            }
        } catch (e) {
            console.error('Error loading payment model:', e);
        }
        
        // Format plan display name
        let displayPlanName = planData.name;
        if (paymentModel) {
            displayPlanName = `${planData.name} - ${paymentModel}`;
        }
        
        // Collect page data
        const pages = [];
        for (let i = 1; i <= planData.pages; i++) {
            const pageCard = document.querySelector(`.page-card[data-page="${i}"]`);
            if (!pageCard) continue;
            
            const pageName = i === 1 ? 'Home' : 
                document.querySelector(`.page-type[data-page="${i}"]`)?.value || 'Not specified';
            const customName = document.querySelector(`.custom-page-name[data-page="${i}"]`)?.value;
            const goal = document.querySelector(`input[name="goal-${i}"]:checked`)?.value || 'ai-decides';
            const instruction = document.querySelector(`.page-instruction[data-page="${i}"]`)?.value || '';
            const aiOverride = document.querySelector(`.ai-override-toggle[data-page="${i}"]`)?.checked || false;
            
            pages.push({
                number: i,
                name: customName || (pageName === 'custom' ? 'Custom' : pageName),
                goal: goal,
                instruction: instruction,
                aiOverride: aiOverride
            });
        }
        
        // Include funnel data in review
        let funnelDataHTML = '';
        if (funnelData.businessName || selectedServices.length > 0) {
            funnelDataHTML = `
                <div class="review-section">
                    <div class="review-header">
                        <i class="fas fa-shopping-cart"></i>
                        <span>Original Order Details</span>
                    </div>
                    ${funnelData.businessName ? `
                    <div class="review-item">
                        <div class="review-label">Business:</div>
                        <div class="review-value">${funnelData.businessName}</div>
                    </div>
                    ` : ''}
                    ${selectedServices.length > 0 ? `
                    <div class="review-item">
                        <div class="review-label">Selected Services:</div>
                        <div class="review-value">
                            ${selectedServices.length} services total
                            ${serviceCounts.standard > 0 ? `<br><span style="color: #4CAF50;">${serviceCounts.standard} Standard</span>` : ''}
                            ${serviceCounts.premium > 0 ? `<br><span style="color: #2196F3;">${serviceCounts.premium} Premium</span>` : ''}
                        </div>
                    </div>
                    ` : ''}
                </div>
            `;
        }
        
        let reviewHTML = `
            ${funnelDataHTML}
            
            <div class="review-section">
                <div class="review-header">
                    <i class="fas fa-box"></i>
                    <span>Your Website Plan</span>
                </div>
                <div class="review-item">
                    <div class="review-label">Plan Type:</div>
                    <div class="review-value">${displayPlanName}</div> <!-- FIXED: Use displayPlanName -->
                </div>
                <div class="review-item">
                    <div class="review-label">Price:</div>
                    <div class="review-value">${planData.price}</div>
                </div>
                <div class="review-item">
                    <div class="review-label">Pages:</div>
                    <div class="review-value">${planData.pages} pages total</div>
                </div>
                <div class="review-item">
                    <div class="review-label">Delivery:</div>
                    <div class="review-value">${planData.delivery}</div>
                </div>
                ${paymentModel ? `
                <div class="review-item">
                    <div class="review-label">Payment Model:</div>
                    <div class="review-value">${paymentModel}</div>
                </div>
                ` : ''}
                ${selectedServices.length > 0 ? `
                <div class="review-item">
                    <div class="review-label">Included Services:</div>
                    <div class="review-value">
                        <div style="display: flex; flex-wrap: wrap; gap: 5px; margin-top: 5px;">
                            ${selectedServices.slice(0, 8).map(service => 
                                `<span style="background: var(--accent-light); color: var(--accent); padding: 2px 8px; border-radius: 12px; font-size: 0.8rem;">${service}</span>`
                            ).join('')}
                            ${selectedServices.length > 8 ? `<span style="color: var(--text-light); font-size: 0.8rem;">+${selectedServices.length - 8} more</span>` : ''}
                        </div>
                    </div>
                </div>
                ` : ''}
            </div>
            
            <div class="review-section">
                <div class="review-header">
                    <i class="fas fa-file"></i>
                    <span>Pages Setup</span>
                </div>
        `;
        
        pages.forEach(page => {
            reviewHTML += `
                <div class="review-item">
                    <div class="review-label">Page ${page.number}:</div>
                    <div class="review-value">
                        <strong>${page.name}</strong>
                        ${page.aiOverride ? '<span style="color: var(--accent); font-style: italic;"> (AI Design)</span>' : ''}
                        <br>
                        <small>Goal: ${page.goal.replace('-', ' ')}</small>
                    </div>
                </div>
            `;
        });
        
        reviewHTML += `</div>`;
        
        // Brand Info
        if (formData.brand.name) {
            reviewHTML += `
                <div class="review-section">
                    <div class="review-header">
                        <i class="fas fa-building"></i>
                        <span>Business Details</span>
                    </div>
                    <div class="review-item">
                        <div class="review-label">Business:</div>
                        <div class="review-value">${formData.brand.name}</div>
                    </div>
                    <div class="review-item">
                        <div class="review-label">Location:</div>
                        <div class="review-value">${formData.brand.location}</div>
                    </div>
                    <div class="review-item">
                        <div class="review-label">Contact:</div>
                        <div class="review-value">${formData.brand.email} ${formData.brand.phone ? `• ${formData.brand.phone}` : ''}</div>
                    </div>
                    <div class="review-item">
                        <div class="review-label">Logo:</div>
                        <div class="review-value">${formData.brand.hasLogo ? 'Uploaded' : 'To be created by VIBZ'}</div>
                    </div>
                </div>
            `;
        }
        
        // Confidence Level
        if (formData.confidence) {
            const confidenceLabels = {
                'very-confident': 'Very Confident',
                'somewhat-confident': 'Somewhat Confident',
                'need-help': 'Needs Help'
            };
            
            reviewHTML += `
                <div class="review-section">
                    <div class="review-header">
                        <i class="fas fa-user-check"></i>
                        <span>Confidence Level</span>
                    </div>
                    <div class="review-item">
                        <div class="review-label">Status:</div>
                        <div class="review-value">${confidenceLabels[formData.confidence] || 'Not specified'}</div>
                    </div>
                </div>
            `;
        }
        
        reviewContent.innerHTML = reviewHTML;
    }

    // ===================== FORM SUBMISSION =====================
    function setupEventListeners() {
        const form = document.getElementById('websiteOrderForm');
        form.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Show loading state
            const submitBtn = document.getElementById('submitBtn');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            // Collect all form data
            const finalData = {
                plan: plan,
                planDetails: PLANS[plan],
                timestamp: new Date().toISOString(),
                pages: [],
                brand: formData.brand,
                confidence: formData.confidence,
                // Include original funnel data
                originalFunnelData: funnelData,
                selectedServices: selectedServices,
                serviceCounts: serviceCounts
            };
            
            // Collect page data
            for (let i = 1; i <= PLANS[plan].pages; i++) {
                const pageCard = document.querySelector(`.page-card[data-page="${i}"]`);
                if (!pageCard) continue;
                
                const pageName = i === 1 ? 'Home' : 
                    document.querySelector(`.page-type[data-page="${i}"]`)?.value || '';
                const customName = document.querySelector(`.custom-page-name[data-page="${i}"]`)?.value;
                const goal = document.querySelector(`input[name="goal-${i}"]:checked`)?.value || '';
                const instruction = document.querySelector(`.page-instruction[data-page="${i}"]`)?.value || '';
                const aiOverride = document.querySelector(`.ai-override-toggle[data-page="${i}"]`)?.checked || false;
                
                finalData.pages.push({
                    number: i,
                    name: i === 1 ? 'Home' : (customName || pageName),
                    goal: goal,
                    instruction: instruction,
                    aiOverride: aiOverride
                });
            }
            
            // Simulate API call
            setTimeout(() => {
                // Store final submission data
                localStorage.setItem('finalOrderData', JSON.stringify(finalData));
                localStorage.setItem('orderSubmitted', 'true');
                localStorage.setItem('orderTimestamp', new Date().toISOString());
                
                // Hide form, show success message
                document.querySelector('.form-container').style.display = 'none';
                document.getElementById('successMessage').style.display = 'block';
                
                console.log('Form submitted with complete data:', finalData);
                
                // In production, you would send this data to your server
                // fetch('/api/orders', { method: 'POST', body: JSON.stringify(finalData) })
                
            }, 1500);
        });
    }

    // ===================== UTILITY FUNCTIONS =====================
    function getPageName(pageNum) {
        if (pageNum === 1) return 'Home';
        
        const select = document.querySelector(`.page-type[data-page="${pageNum}"]`);
        const customInput = document.querySelector(`.custom-page-name[data-page="${pageNum}"]`);
        
        if (select && select.value === 'custom' && customInput) {
            return customInput.value || 'Custom Page';
        }
        
        return select ? select.selectedOptions[0]?.text : 'Page ' + pageNum;
    }
</script>


</body>
</html>
