<!DOCTYPE html>
<html lang="en"> 
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIBZ | Barber Website Funnel</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
        /* ========== Root & General Styles ========== */
        :root {
            --primary: #FF6B00;
            --dark: #121212;
            --light: #ffffff;
            --gray: #4a4a4a;
            --light-gray: #f9f9f9;
            --border: #eeeeee;
            --transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            --standard-green: #4CAF50;
            --premium-blue: #2196F3;
        }

        * { margin:0; padding:0; box-sizing:border-box; }
        body { font-family:'Inter',sans-serif; background-color:var(--light); color:var(--dark); line-height:1.6; overflow-x:hidden; scroll-behavior:smooth; }
        h1,h2,h3,h4,h5 { font-weight:900; line-height:1.1; letter-spacing:-1px; }

        .container { width:100%; max-width:1200px; margin:0 auto; padding:0 30px; }

        /* ========== Header ========== */
        header { position:fixed; top:0; left:0; width:100%; z-index:1000; padding:20px 0; transition:var(--transition); background:rgba(255,255,255,0.95); backdrop-filter:blur(10px); border-bottom:1px solid var(--border); }
        .nav-container { display:flex; justify-content:space-between; align-items:center; }
        .logo { font-size:28px; font-weight:900; color:var(--primary); text-decoration:none; letter-spacing:-1px; }
        .logo::after { content:"."; color:#000; margin-left:2px; font-weight:900; }
        .nav-links { display:flex; gap:40px; }
        .nav-links a { color:var(--dark); text-decoration:none; font-weight:600; font-size:16px; position:relative; transition:var(--transition); }
        .nav-links a:hover { color:var(--primary); }
        .mobile-menu-btn { display:none; background:none; border:none; color:var(--dark); font-size:24px; cursor:pointer; }

        /* ========== Funnel Section ========== */
        .funnel-section { min-height:100vh; padding-top:150px; padding-bottom:60px; display:flex; justify-content:center; align-items:center; text-align:center; background:radial-gradient(circle at top right, #fff5ee, #ffffff); }

        .form-screen { width:100%; max-width:800px; margin:0 auto; display:none; opacity:0; transition:opacity 0.5s ease; }
        .form-screen.active { display:block; opacity:1; animation:fadeIn 0.5s ease forwards; }
        .form-screen h2 { font-size:3rem; margin-bottom:1.5rem; letter-spacing:-1px; }
        .form-screen p { font-size:1.2rem; color:var(--gray); max-width:600px; margin:0 auto 2rem; line-height:1.6; }

        /* ========== Buttons ========== */
        .vibz-btn { background-color:transparent; color:var(--primary); border:2px solid var(--primary); border-radius:12px; font-weight:700; padding:1.2rem 2.5rem; font-size:1.1rem; cursor:pointer; transition:var(--transition); text-decoration:none; display:inline-block; margin:0.5rem; min-width:200px; }
        .vibz-btn:hover { background:var(--primary); color:white; transform:scale(1.05); box-shadow:0 15px 30px rgba(255,107,0,0.2); }
        .vibz-btn-primary { background:var(--primary); color:white; border:2px solid var(--primary); }
        .vibz-btn-primary:hover { background:white; color:var(--primary); }
        .back-button { background-color:var(--light-gray); color:var(--gray); border:2px solid var(--border); margin-top:2rem; }
        .back-button:hover { background-color:var(--border); color:var(--dark); transform:scale(1.02); box-shadow:0 10px 20px rgba(0,0,0,0.1); }

        /* ========== Step Options ========== */
        .step-options-large {
            margin: 3rem 0;
        }

        .step-options-large .vibz-btn {
            min-width: 300px;
            padding: 1.5rem 2.5rem;
            font-size: 1.2rem;
            margin: 1rem;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

        /* ========== Lead Capture Form Styles ========== */
        .lead-form-container {
            background: white;
            padding: 3rem;
            border-radius: 32px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.08);
            max-width: 600px;
            margin: 0 auto;
            text-align: left;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--dark);
            font-size: 0.95rem;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 1rem 1.2rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 1rem;
            font-family: 'Inter', sans-serif;
            transition: var(--transition);
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(255,107,0,0.1);
        }

        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        .form-note {
            font-size: 0.85rem;
            color: var(--gray);
            margin-top: 0.5rem;
            font-style: italic;
        }

        .submit-btn {
            width: 100%;
            padding: 1.2rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 1rem;
        }

        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(255,107,0,0.3);
        }

        /* ========== Step 1 input styling ========== */
        #step-1 input[type="text"] {
            width: 100%;
            padding: 1rem 1.2rem;
            font-size: 1rem;
            border: 2px solid var(--gray);
            border-radius: 0.5rem;
            margin-bottom: 1.5rem;
            box-sizing: border-box;
        }

        #step-1 input[type="text"]:focus {
            border-color: var(--primary);
            outline: none;
        }

        /* Feature button selection styles */
        .vibz-btn.selected {
            background-color: #FF6B00 !important;
            color: white !important;
            border-color: #FF6B00 !important;
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(255, 107, 0, 0.2);
        }

        /* Design info box */
        .design-info-box {
            animation: fadeIn 0.5s ease;
        }

        /* ========== Step 4: Code Input & Concept Display ========== */
        .code-input-container {
            max-width: 500px;
            margin: 0 auto 3rem;
        }

        .code-input-large {
            width: 100%;
            padding: 1.5rem;
            font-size: 1.3rem;
            border: 3px solid var(--border);
            border-radius: 15px;
            text-align: center;
            font-weight: 700;
            letter-spacing: 1px;
            transition: var(--transition);
            margin-bottom: 1rem;
        }

        .code-input-large:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(255, 107, 0, 0.1);
        }

        .code-status {
            padding: 1rem;
            border-radius: 10px;
            margin: 1rem 0;
            font-weight: 600;
            display: none;
        }

        .code-status.success {
            background: rgba(76, 175, 80, 0.1);
            color: #2e7d32;
            border: 1px solid rgba(76, 175, 80, 0.3);
            display: block;
        }

        .code-status.error {
            background: rgba(244, 67, 54, 0.1);
            color: #d32f2f;
            border: 1px solid rgba(244, 67, 54, 0.3);
            display: block;
        }

        /* Concept Display Card */
        .concept-display-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            border: 2px solid var(--border);
            transition: var(--transition);
            max-width: 500px;
            margin: 2rem auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.05);
        }

        .concept-display-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.1);
            border-color: var(--primary);
        }

        .concept-display-image {
            height: 350px;
            position: relative;
            overflow: hidden;
            background: #000;
        }

        .concept-display-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.8s ease;
        }

        .concept-display-card:hover .concept-display-image img {
            transform: scale(1.05);
        }

        .concept-display-code {
            padding: 2rem;
            background: white;
            border-top: 1px solid var(--border);
        }

        .concept-display-code .code-label {
            font-size: 0.9rem;
            color: var(--gray);
            text-transform: uppercase;
            letter-spacing: 2px;
            font-weight: 700;
            margin-bottom: 0.5rem;
            display: block;
        }

        .concept-display-code .code-value {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--primary);
            letter-spacing: -1px;
        }

        /* ========== Service Cards ========== */
        .service-card {
            background: rgba(76, 175, 80, 0.05);
            border: 2px solid rgba(76, 175, 80, 0.3);
            border-radius: 12px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .service-card.premium {
            background: rgba(33, 150, 243, 0.05);
            border: 2px solid rgba(33, 150, 243, 0.3);
        }
        
        .service-card.selected {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .service-card.standard.selected {
            background: rgba(76, 175, 80, 0.15);
            border-color: #4CAF50;
        }
        
        .service-card.premium.selected {
            background: rgba(33, 150, 243, 0.15);
            border-color: #2196F3;
        }
        
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin: 2rem 0;
            max-height: 500px;
            overflow-y: auto;
            padding: 10px;
        }
        
        /* ========== Glow Effect ========== */
        .recommended-glow {
            position: relative;
            z-index: 1;
        }
        
        .recommended-glow::before {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            background: linear-gradient(45deg, #FF6B00, #FF8B00, #FF6B00);
            border-radius: 40px;
            z-index: -1;
            opacity: 0.3;
            filter: blur(20px);
            animation: glowPulse 3s infinite;
        }
        
        @keyframes glowPulse {
            0% { opacity: 0.3; }
            50% { opacity: 0.5; }
            100% { opacity: 0.3; }
        }

        /* ========== Pricing Cards ========== */
        .pricing-container { display:grid; grid-template-columns:repeat(auto-fit, minmax(280px,1fr)); gap:30px; margin-top:40px; }
        .pricing-card { padding:3rem 2.5rem; background:var(--light-gray); border-radius:32px; position:relative; overflow:hidden; transition:var(--transition); border:1px solid transparent; }
        .pricing-card:hover { background:white; border-color:var(--primary); transform:translateY(-10px); box-shadow:0 30px 60px rgba(0,0,0,0.05); }
        .pricing-card h3 { font-size:1.8rem; margin-bottom:1rem; color:var(--dark); }
        .price { font-size:3rem; font-weight:900; color:var(--primary); margin:1.5rem 0; display:block; }
        .price-period { font-size:1rem; color:var(--gray); font-weight:normal; }
        .pricing-features { list-style:none; text-align:left; margin:2rem 0; }
        .pricing-features li { margin-bottom:1rem; padding-left:30px; position:relative; }
        .pricing-features li:before { content:"✓"; position:absolute; left:0; color:var(--primary); font-weight:bold; }

        /* Success message */
        .success-message { background:var(--light-gray); padding:3rem; border-radius:32px; margin-top:2rem; border:1px solid var(--border); }
        .success-message h3 { color:var(--primary); margin-bottom:1rem; }

        /* ========== Responsive ========== */
        @media(max-width:768px) {
            .nav-links { display:none; }
            .mobile-menu-btn { display:block; }
            .form-screen h2 { font-size:2.5rem; }
            .form-screen p { font-size:1.1rem; padding:0 20px; }
            .step-options-large .vibz-btn { min-width: 250px; font-size: 1.1rem; padding: 1.2rem 2rem; }
            .vibz-btn { min-width:180px; padding:1rem 1.5rem; }
            .pricing-container { grid-template-columns:1fr; }
            .concept-display-image { height: 250px; }
            .concept-display-code .code-value { font-size: 2rem; }
            .services-grid { grid-template-columns: 1fr; }
            .form-row { grid-template-columns: 1fr; }
            .lead-form-container { padding: 2rem; }
        }
        @media(max-width:480px) {
            .form-screen h2 { font-size:2rem; }
            .vibz-btn { width:100%; max-width:280px; }
            .code-input-large { font-size: 1.1rem; padding: 1.2rem; }
            .lead-form-container { padding: 1.5rem; }
            .step-options-large .vibz-btn { min-width: 100%; max-width: 300px; }
        }

        @keyframes fadeIn { 
            from { opacity:0; transform:translateY(20px); } 
            to { opacity:1; transform:translateY(0); } 
        }
    </style>
</head>
<body>

<!-- Header -->
<header id="header">
    <div class="container nav-container">
        <a href="#" class="logo">VIBZ</a>
        <nav class="nav-links">
            <a href="#home">Home</a>
            <a href="#portfolio">Portfolio</a>
            <a href="#process">Process</a>
            <a href="#contact">Contact</a>
        </nav>
        <button class="mobile-menu-btn" id="mobileMenuBtn"><i class="fas fa-bars"></i></button>
    </div>
</header>

<section class="funnel-section">
    <div class="container">
        <!-- Step Indicators - 13 steps total -->
        <div class="step-indicator">
            <div class="step-dot active" data-step="1"></div>
            <div class="step-dot" data-step="2"></div>
            <div class="step-dot" data-step="3"></div>
            <div class="step-dot" data-step="4"></div>
            <div class="step-dot" data-step="5"></div>
            <div class="step-dot" data-step="6"></div>
            <div class="step-dot" data-step="7"></div>
            <div class="step-dot" data-step="8"></div>
            <div class="step-dot" data-step="9"></div>
            <div class="step-dot" data-step="10"></div>
            <div class="step-dot" data-step="11"></div>
            <div class="step-dot" data-step="12"></div>
            <div class="step-dot" data-step="13"></div>
        </div>

        <form id="formWrapper">
            <!-- Hidden fields -->
            <input type="hidden" id="hiddenPlan" name="Selected Plan">
            <input type="hidden" id="hiddenFeatures" name="Selected Features">
            <input type="hidden" id="hiddenPaymentLink" name="Payment Link">
            <input type="hidden" id="hiddenDesignCode" name="Design Code">

            <!-- STEP 1-9: Existing steps (unchanged) -->
            <!-- STEP 1: Barber Shop Name -->
            <div class="form-screen active" id="step-1">
                <h2>What's Your Barber Shop Name?</h2>
                <p>Tell us your barber shop name so we can personalize your experience.</p>
                <input type="text" id="businessInput" placeholder="e.g. The Gentlemen's Cut">
                <button type="button" class="vibz-btn vibz-btn-primary" onclick="handleBusinessName()">Next</button>
            </div>

            <!-- STEP 2: Project Type -->
            <div class="form-screen" id="step-2">
                <h2>Which service do you need?</h2>
                <div class="options">
                    <button type="button" class="vibz-btn" onclick="setProjectType('New Website')">New Website</button>
                    <button type="button" class="vibz-btn" onclick="setProjectType('Redesign Existing')">Redesign Existing</button>
                    <button type="button" class="vibz-btn" onclick="setProjectType('Maintenance')">Maintenance</button>
                </div>
                <button type="button" class="vibz-btn back-button" onclick="prev()">← Go Back</button>
            </div>

            <!-- STEP 3: Design Concept -->
            <div class="form-screen" id="step-3">
                <h2 id="step3Title">Do you have a design concept in mind?</h2>
                <p id="step3Message">You can enter a code, choose from templates, or request custom design.</p>
                
                <!-- Show design info if coming from concepts page -->
                <div id="designInfo" style="display: none; background: rgba(255, 107, 0, 0.1); padding: 1rem; border-radius: 12px; margin-bottom: 1.5rem; border: 2px solid #FF6B00;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div style="font-size: 1.5rem; color: #FF6B00;">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div>
                            <p style="margin: 0; color: #121212; font-weight: 700; font-size: 1.1rem;">
                                Design Selected: <span id="selectedDesignCode" style="color: #FF6B00;"></span>
                            </p>
                        </div>
                    </div>
                </div>
                
                <div class="options">
                    <button type="button" class="vibz-btn" onclick="setDesignConcept('Code')" id="codeBtn">Yes, I have a code</button>
                    <a href="https://www.vibz.co.uk/barber/concepts.html" class="vibz-btn">Show me concepts</a>
                    <button type="button" class="vibz-btn" onclick="setDesignConcept('Custom')">Custom design</button>
                </div>
                <button type="button" class="vibz-btn back-button" onclick="prev()">← Go Back</button>
            </div>

            <!-- STEP 4: Code Input & Concept Display -->
            <div class="form-screen" id="step-4">
                <h2>Enter Your Design Code</h2>
                <p>Type the code for your chosen design (e.g., barber-1, barber-2, etc.)</p>
                
                <div class="code-input-container">
                    <input type="text" 
                           class="code-input-large" 
                           id="designCodeInput" 
                           placeholder="Enter code (e.g., barber-5)"
                           autocomplete="off">
                    
                    <div id="codeStatus" class="code-status"></div>
                    
                    <div id="conceptDisplay" style="display: none;">
                        <div class="concept-display-card">
                            <div class="concept-display-image">
                                <img id="conceptDisplayImage" src="" alt="Design Preview">
                            </div>
                            <div class="concept-display-code">
                                <span class="code-label">Design Code</span>
                                <div class="code-value" id="conceptDisplayCode"></div>
                            </div>
                        </div>
                        
                        <button type="button" class="vibz-btn vibz-btn-primary" onclick="confirmDesignSelection()" id="confirmDesignBtn">
                            Continue with This Design
                        </button>
                    </div>
                    
                    <button type="button" class="vibz-btn" onclick="tryDifferentCode()" id="tryDifferentBtn" style="display: none; margin-top: 1rem;">
                        Try Different Code
                    </button>
                </div>
                
                <div style="margin-top: 2rem;">
                    <p style="color: var(--gray); font-size: 0.9rem;">
                        <i class="fas fa-info-circle"></i> 
                        Accepted formats: "barber-1", "barber 1", "BARBER-1", "B1", or just "1"
                    </p>
                </div>
                
                <button type="button" class="vibz-btn back-button" onclick="prev()">← Go Back</button>
            </div>
            
            <!-- STEP 5: Target Audience -->
            <div class="form-screen" id="step-5">
                <h2>Who are your main clients?</h2>
                <div class="options">
                    <button type="button" class="vibz-btn" onclick="setAudience('Men')">Men</button>
                    <button type="button" class="vibz-btn" onclick="setAudience('Women')">Women</button>
                    <button type="button" class="vibz-btn" onclick="setAudience('Children')">Children</button>
                    <button type="button" class="vibz-btn" onclick="setAudience('Family')">Mixed/Family</button>
                </div>
                <button type="button" class="vibz-btn back-button" onclick="prev()">← Go Back</button>
            </div>

            <!-- STEP 6: Website Style -->
            <div class="form-screen" id="step-6">
                <h2>What style do you prefer for your website?</h2>
                <div class="options">
                    <button type="button" class="vibz-btn" onclick="setStyle('Classic')">Classic</button>
                    <button type="button" class="vibz-btn" onclick="setStyle('Modern')">Modern</button>
                    <button type="button" class="vibz-btn" onclick="setStyle('Minimalist')">Minimalist</button>
                    <button type="button" class="vibz-btn" onclick="setStyle('Premium')">Premium</button>
                </div>
                <button type="button" class="vibz-btn back-button" onclick="prev()">← Go Back</button>
            </div>

            <!-- STEP 7: Color Scheme -->
            <div class="form-screen" id="step-7">
                <h2>Preferred color scheme?</h2>
                <div class="options">
                    <button type="button" class="vibz-btn" onclick="setColor('Black & Gold')">Black & Gold</button>
                    <button type="button" class="vibz-btn" onclick="setColor('Modern/Vibrant')">Modern/Vibrant</button>
                    <button type="button" class="vibz-btn" onclick="setColor('Neutral/Classic')">Neutral/Classic</button>
                    <button type="button" class="vibz-btn" onclick="setColor('Custom')">Custom</button>
                </div>
                <button type="button" class="vibz-btn back-button" onclick="prev()">← Go Back</button>
            </div>

            <!-- STEP 8: Website Goal -->
            <div class="form-screen" id="step-8">
                <h2>What's the main goal of your website?</h2>
                <div class="options">
                    <button type="button" class="vibz-btn" onclick="setGoal('Attract New Clients')">Attract New Clients</button>
                    <button type="button" class="vibz-btn" onclick="setGoal('Showcase Styles/Portfolio')">Showcase Styles/Portfolio</button>
                    <button type="button" class="vibz-btn" onclick="setGoal('Facilitate Bookings')">Facilitate Bookings</button>
                </div>
                <button type="button" class="vibz-btn back-button" onclick="prev()">← Go Back</button>
            </div>

            <!-- STEP 9: Services Selection -->
            <div class="form-screen" id="step-9">
                <h2 id="step9Title">Select Your Website Services</h2>
                <p id="step9Message">Choose the features you need for your barbershop website:</p>
                
                <!-- Booking Method Section REMOVED -->
                
                <!-- Tier Indicators -->
                <div class="tier-indicators" style="display: flex; justify-content: center; gap: 30px; margin: 2rem 0; flex-wrap: wrap;">
                    <div style="text-align: center; background: rgba(76, 175, 80, 0.1); padding: 10px 20px; border-radius: 10px; border: 2px solid #4CAF50;">
                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 5px;">
                            <div style="width: 16px; height: 16px; background: #4CAF50; border-radius: 50%;"></div>
                            <span style="font-weight: 700; color: #4CAF50;">STANDARD PACKAGE</span>
                        </div>
                        <span style="font-size: 0.85rem; color: var(--gray);">Professional Web Presence</span>
                    </div>
                    <div style="text-align: center; background: rgba(33, 150, 243, 0.1); padding: 10px 20px; border-radius: 10px; border: 2px solid #2196F3;">
                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 5px;">
                            <div style="width: 16px; height: 16px; background: #2196F3; border-radius: 50%;"></div>
                            <span style="font-weight: 700; color: #2196F3;">PREMIUM PACKAGE</span>
                        </div>
                        <span style="font-size: 0.85rem; color: var(--gray);">Revenue-Boosting Features</span>
                    </div>
                </div>


                
                
                <!-- Services Grid -->
                <div class="services-grid">
                    <!-- ===== STANDARD PACKAGE SERVICES ===== -->
                    <div class="service-card standard" onclick="toggleService('Services & Pricing Display', this)">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <div style="width: 24px; height: 24px; background: #4CAF50; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: 700;">S</div>
                            <h4 style="margin: 0; font-size: 1.1rem;">Services & Pricing Display</h4>
                        </div>
                        <p style="color: var(--gray); font-size: 0.9rem; margin: 0;">Clear display of all services and prices</p>
                    </div>
                    
                    <div class="service-card standard" onclick="toggleService('Barber Profiles / Team Section', this)">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <div style="width: 24px; height: 24px; background: #4CAF50; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: 700;">S</div>
                            <h4 style="margin: 0; font-size: 1.1rem;">Barber Profiles / Team Section</h4>
                        </div>
                        <p style="color: var(--gray); font-size: 0.9rem; margin: 0;">Introduce your team with bios and photos</p>
                    </div>
                    
                    <div class="service-card standard" onclick="toggleService('Photo Gallery / Portfolio', this)">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <div style="width: 24px; height: 24px; background: #4CAF50; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: 700;">S</div>
                            <h4 style="margin: 0; font-size: 1.1rem;">Photo Gallery / Portfolio</h4>
                        </div>
                        <p style="color: var(--gray); font-size: 0.9rem; margin: 0;">Showcase your work with high-quality images</p>
                    </div>
                    
                    <div class="service-card standard" onclick="toggleService('Before & After Slider', this)">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <div style="width: 24px; height: 24px; background: #4CAF50; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: 700;">S</div>
                            <h4 style="margin: 0; font-size: 1.1rem;">Before & After Slider</h4>
                        </div>
                        <p style="color: var(--gray); font-size: 0.9rem; margin: 0;">Interactive before/after image comparison</p>
                    </div>
                    
                    <div class="service-card standard" onclick="toggleService('Special Offers / Promotions Section', this)">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <div style="width: 24px; height: 24px; background: #4CAF50; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: 700;">S</div>
                            <h4 style="margin: 0; font-size: 1.1rem;">Special Offers / Promotions</h4>
                        </div>
                        <p style="color: var(--gray); font-size: 0.9rem; margin: 0;">Display current deals and promotions</p>
                    </div>
                    
                    <div class="service-card standard" onclick="toggleService('Location & Directions', this)">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <div style="width: 24px; height: 24px; background: #4CAF50; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: 700;">S</div>
                            <h4 style="margin: 0; font-size: 1.1rem;">Location & Directions</h4>
                        </div>
                        <p style="color: var(--gray); font-size: 0.9rem; margin: 0;">Google Maps integration with directions</p>
                    </div>
                    
                    <div class="service-card standard" onclick="toggleService('Tap-to-Call & WhatsApp Buttons', this)">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <div style="width: 24px; height: 24px; background: #4CAF50; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: 700;">S</div>
                            <h4 style="margin: 0; font-size: 1.1rem;">Tap-to-Call & WhatsApp</h4>
                        </div>
                        <p style="color: var(--gray); font-size: 0.9rem; margin: 0;">One-click calling and WhatsApp messaging</p>
                    </div>
                    
                    <div class="service-card standard" onclick="toggleService('Opening Hours Display', this)">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <div style="width: 24px; height: 24px; background: #4CAF50; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: 700;">S</div>
                            <h4 style="margin: 0; font-size: 1.1rem;">Opening Hours Display</h4>
                        </div>
                        <p style="color: var(--gray); font-size: 0.9rem; margin: 0;">Interactive hours with open/closed status</p>
                    </div>
                    
                    <div class="service-card standard" onclick="toggleService('Membership / Loyalty Program Section', this)">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <div style="width: 24px; height: 24px; background: #4CAF50; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: 700;">S</div>
                            <h4 style="margin: 0; font-size: 1.1rem;">Membership / Loyalty Program</h4>
                        </div>
                        <p style="color: var(--gray); font-size: 0.9rem; margin: 0;">Display your loyalty program details</p>
                    </div>
                    
                    <div class="service-card standard" onclick="toggleService('FAQ Section', this)">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <div style="width: 24px; height: 24px; background: #4CAF50; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: 700;">S</div>
                            <h4 style="margin: 0; font-size: 1.1rem;">FAQ Section</h4>
                        </div>
                        <p style="color: var(--gray); font-size: 0.9rem; margin: 0;">Answers to common client questions</p>
                    </div>
                    
                    <!-- ===== PREMIUM PACKAGE SERVICES ===== -->
                    <div class="service-card premium" onclick="toggleService('Online Booking System Embed', this)">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <div style="width: 24px; height: 24px; background: #2196F3; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: 700;">P</div>
                            <h4 style="margin: 0; font-size: 1.1rem;">Online Booking System Embed</h4>
                        </div>
                        <p style="color: var(--gray); font-size: 0.9rem; margin: 0;">Calendly/Setmore integration for bookings</p>
                    </div>
                    
                    <div class="service-card premium" onclick="toggleService('Stripe Payment / Deposit Integration', this)">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <div style="width: 24px; height: 24px; background: #2196F3; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: 700;">P</div>
                            <h4 style="margin: 0; font-size: 1.1rem;">Stripe Payment Integration</h4>
                        </div>
                        <p style="color: var(--gray); font-size: 0.9rem; margin: 0;">Secure online payments and deposits</p>
                    </div>
                    
                    <div class="service-card premium" onclick="toggleService('Automated Booking Reminders', this)">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <div style="width: 24px; height: 24px; background: #2196F3; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: 700;">P</div>
                            <h4 style="margin: 0; font-size: 1.1rem;">Automated Booking Reminders</h4>
                        </div>
                        <p style="color: var(--gray); font-size: 0.9rem; margin: 0;">Email/SMS reminders via booking tool</p>
                    </div>
                    
                    <div class="service-card premium" onclick="toggleService('Appointment Cancellation / Reschedule Info', this)">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <div style="width: 24px; height: 24px; background: #2196F3; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: 700;">P</div>
                            <h4 style="margin: 0; font-size: 1.1rem;">Cancellation & Reschedule Info</h4>
                        </div>
                        <p style="color: var(--gray); font-size: 0.9rem; margin: 0;">Clear policies and rescheduling options</p>
                    </div>
                    
                    <div class="service-card premium" onclick="toggleService('Gift Card / Voucher Section', this)">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <div style="width: 24px; height: 24px; background: #2196F3; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: 700;">P</div>
                            <h4 style="margin: 0; font-size: 1.1rem;">Gift Card / Voucher Section</h4>
                        </div>
                        <p style="color: var(--gray); font-size: 0.9rem; margin: 0;">Sell and manage digital gift cards</p>
                    </div>
                    
                    <div class="service-card premium" onclick="toggleService('Kids / Senior / Special Service Tags', this)">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <div style="width: 24px; height: 24px; background: #2196F3; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: 700;">P</div>
                            <h4 style="margin: 0; font-size: 1.1rem;">Special Service Tags</h4>
                        </div>
                        <p style="color: var(--gray); font-size: 0.9rem; margin: 0;">Highlight kids, seniors, specialty services</p>
                    </div>
                    
                    <div class="service-card premium" onclick="toggleService('Walk-In / Waitlist Info Section', this)">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <div style="width: 24px; height: 24px; background: #2196F3; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: 700;">P</div>
                            <h4 style="margin: 0; font-size: 1.1rem;">Walk-In & Waitlist Info</h4>
                        </div>
                        <p style="color: var(--gray); font-size: 0.9rem; margin: 0;">Real-time waitlist and walk-in updates</p>
                    </div>
                    
                    <div class="service-card premium" onclick="toggleService('Barber Specialties Tags', this)">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <div style="width: 24px; height: 24px; background: #2196F3; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: 700;">P</div>
                            <h4 style="margin: 0; font-size: 1.1rem;">Barber Specialties Tags</h4>
                        </div>
                        <p style="color: var(--gray); font-size: 0.9rem; margin: 0;">Highlight specific skills and specialties</p>
                    </div>
                    
                    <div class="service-card premium" onclick="toggleService('Prominent Call-to-Action Buttons', this)">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <div style="width: 24px; height: 24px; background: #2196F3; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: 700;">P</div>
                            <h4 style="margin: 0; font-size: 1.1rem;">Prominent Call-to-Action Buttons</h4>
                        </div>
                        <p style="color: var(--gray); font-size: 0.9rem; margin: 0;">Strategic buttons to drive conversions</p>
                    </div>
                    
                    <div class="service-card premium" onclick="toggleService('Enhanced Before & After Slider', this)">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <div style="width: 24px; height: 24px; background: #2196F3; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: 700;">P</div>
                            <h4 style="margin: 0; font-size: 1.1rem;">Enhanced Before & After Slider</h4>
                        </div>
                        <p style="color: var(--gray); font-size: 0.9rem; margin: 0;">Interactive slider with filtering options</p>
                    </div>
                </div>


    
                
                <!-- Selection Summary -->
                <div id="selectionSummary" style="background: var(--light-gray); padding: 1.5rem; border-radius: 15px; margin: 2rem 0; border: 2px solid var(--border);">
                    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
                        <div>
                            <h4 style="margin-bottom: 0.5rem;">Your Selections</h4>
                            <div style="display: flex; gap: 2rem; flex-wrap: wrap;">
                                <div>
                                    <span style="font-size: 0.9rem; color: var(--gray);">Standard Services:</span>
                                    <div style="font-weight: 700; color: #4CAF50; font-size: 1.5rem;" id="standardCount">0</div>
                                </div>
                                <div>
                                    <span style="font-size: 0.9rem; color: var(--gray);">Premium Services:</span>
                                    <div style="font-weight: 700; color: #2196F3; font-size: 1.5rem;" id="premiumCount">0</div>
                                </div>
                                <div>
                                    <span style="font-size: 0.9rem; color: var(--gray);">Total Selected:</span>
                                    <div style="font-weight: 700; color: var(--dark); font-size: 1.5rem;" id="totalCount">0</div>
                                </div>
                            </div>
                        </div>
                        <div>
                            <div id="planRecommendationPreview" style="background: linear-gradient(90deg, #2196F3, #21CBF3); color: white; padding: 0.8rem 1.5rem; border-radius: 25px; font-weight: 700; display: none; box-shadow: 0 5px 15px rgba(33, 150, 243, 0.3);">
                                <i class="fas fa-star"></i> Recommended: <span id="recommendedPlanPreview">Premium</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Plan Recommendation Logic -->
                    <div id="planLogicInfo" style="margin-top: 1rem; padding: 1rem; background: rgba(33, 150, 243, 0.05); border-radius: 10px; display: none;">
                        <p style="margin: 0; font-size: 0.9rem; color: var(--gray);">
                            <i class="fas fa-info-circle" style="color: #2196F3;"></i>
                            <strong>Selection Logic:</strong> 
                            <span id="planLogicText">Select 3+ Premium services for Premium recommendation</span>
                        </p>
                    </div>
                    
                    <div id="selectedServicesList" style="margin-top: 1rem; display: none;">
                        <p style="font-size: 0.9rem; color: var(--gray); margin-bottom: 0.5rem;">Selected Services:</p>
                        <div id="servicesList" style="display: flex; flex-wrap: wrap; gap: 0.5rem;"></div>
                    </div>
                </div>
                
                <button type="button" class="vibz-btn vibz-btn-primary" onclick="nextFromServices()" style="margin-top: 1rem; padding: 1.2rem 3rem; font-size: 1.1rem;">
                    <i class="fas fa-arrow-right"></i> Continue
                </button>
                
                <button type="button" class="vibz-btn back-button" onclick="prev()">← Go Back</button>
            </div>

            <!-- STEP 10: ONLY THE URGENCY QUESTION -->
            <div class="form-screen" id="step-10">
                <h2>What would you like to do next?</h2>
                <p>Help us understand your timeline and preference:</p>
                
                <div class="step-options-large">
                    <button type="button" class="vibz-btn" onclick="setUrgency('Start ASAP')">
                        <i class="fas fa-bolt"></i> I want to start my website ASAP
                    </button>
                    <button type="button" class="vibz-btn" onclick="setUrgency('More Info')">
                        <i class="fas fa-info-circle"></i> I need more information
                    </button>
                </div>
                
                <button type="button" class="vibz-btn back-button" onclick="prev()">← Go Back</button>
            </div>

            <!-- STEP 11: ONLY THE OWNERSHIP MODEL QUESTION -->
            <div class="form-screen" id="step-11">
                <h2>How would you like to pay for your website?</h2>
                <p>Do you want to own the website outright or prefer monthly support including hosting and maintenance?</p>
                
                <div class="step-options-large">
                    <button type="button" class="vibz-btn" onclick="setPlanModel('Own Outright')">
                        <i class="fas fa-crown"></i> Own Outright
                        <div style="font-size: 0.9rem; margin-top: 0.5rem; font-weight: 500; color: var(--gray);">
                            One-time payment • Full ownership
                        </div>
                    </button>
                    <button type="button" class="vibz-btn" onclick="setPlanModel('Monthly Support')">
                        <i class="fas fa-calendar-alt"></i> Monthly Support
                        <div style="font-size: 0.9rem; margin-top: 0.5rem; font-weight: 500; color: var(--gray);">
                            Monthly subscription • All-inclusive
                        </div>
                    </button>
                </div>
                
                <button type="button" class="vibz-btn back-button" onclick="prev()">← Go Back</button>
            </div>

            <!-- STEP 12: Lead Capture Form (for "I need more info") -->
            <div class="form-screen" id="step-12">
                <h2>Get More Information</h2>
                <p>Fill out the form below and we'll contact you with detailed information about our services and pricing.</p>
                
                <div class="lead-form-container">
                    <form id="leadCaptureForm" onsubmit="submitLeadForm(event)">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="leadName">Full Name *</label>
                                <input type="text" id="leadName" name="name" required>
                            </div>
                            <div class="form-group">
                                <label for="leadEmail">Email Address *</label>
                                <input type="email" id="leadEmail" name="email" required>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="leadPhone">Phone Number *</label>
                                <input type="tel" id="leadPhone" name="phone" required>
                            </div>
                            <div class="form-group">
                                <label for="leadBusiness">Business Name</label>
                                <input type="text" id="leadBusiness" name="business" value="${formData.businessName || ''}">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="leadLocation">Barbershop Location (City)</label>
                            <input type="text" id="leadLocation" name="location" placeholder="e.g., London, Manchester">
                        </div>
                        
                        <div class="form-group">
                            <label for="leadTimeline">When are you looking to start? *</label>
                            <select id="leadTimeline" name="timeline" required>
                                <option value="">Select timeline</option>
                                <option value="ASAP">Immediately (ASAP)</option>
                                <option value="1-2 weeks">Within 1-2 weeks</option>
                                <option value="1 month">Within 1 month</option>
                                <option value="2-3 months">Within 2-3 months</option>
                                <option value="Just exploring">Just exploring options</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="leadBudget">Estimated Budget</label>
                            <select id="leadBudget" name="budget">
                                <option value="">Select budget range</option>
                                <option value="Under £1,000">Under £1,000</option>
                                <option value="£1,000 - £2,000">£1,000 - £2,000</option>
                                <option value="£2,000 - £3,000">£2,000 - £3,000</option>
                                <option value="£3,000+">£3,000+</option>
                                <option value="Monthly subscription">Monthly subscription preferred</option>
                                <option value="Not sure">Not sure yet</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="leadQuestions">Specific Questions or Requirements</label>
                            <textarea id="leadQuestions" name="questions" placeholder="Tell us about your specific needs, questions, or any requirements you have..."></textarea>
                        </div>
                        
                        <div class="form-note">
                            <i class="fas fa-info-circle"></i> We'll contact you within 24 hours to discuss your project.
                        </div>
                        
                        <button type="submit" class="submit-btn">
                            <i class="fas fa-paper-plane"></i> Send My Information
                        </button>
                    </form>
                </div>
                
                <button type="button" class="vibz-btn back-button" onclick="goBackToStep10()">← Go Back</button>
            </div>

            <!-- STEP 13: Show Plans (for "Start ASAP" users) -->
            <div class="form-screen" id="step-13">
                <h2>Your Recommended Plan</h2>
                <p id="planRecommendation">Based on your selections, here's what we recommend:</p>
                <div class="pricing-container" id="pricingCards">
                    <!-- Plans will be shown here based on Own Outright vs Monthly Support -->
                </div>
                <button type="button" class="vibz-btn back-button" onclick="prev()">← Go Back</button>
            </div>
        </form>
    </div>
</section>

<script>
// ========== BARBER CONCEPTS DATABASE ==========
const barberConcepts = [
    { code: "barber-1", image: "https://images.unsplash.com/photo-1585747860715-2ba37e788b70?ixlib=rb-1.2.1&auto=format&fit=crop&w=1600&q=80" },
    { code: "barber-2", image: "https://images.unsplash.com/photo-1599351431202-1e0f0137899a?ixlib=rb-1.2.1&auto=format&fit=crop&w=1600&q=80" },
    { code: "barber-3", image: "https://images.unsplash.com/photo-1567894340315-735d7c361db0?ixlib=rb-1.2.1&auto=format&fit=crop&w=1600&q=80" },
    { code: "barber-4", image: "https://images.unsplash.com/photo-1596462502278-27bfdc403348?ixlib=rb-1.2.1&auto=format&fit=crop&w=1600&q=80" },
    { code: "barber-5", image: "https://images.unsplash.com/photo-1562157873-818bc0726f68?ixlib=rb-1.2.1&auto=format&fit=crop&w=1600&q=80" },
    { code: "barber-6", image: "https://images.unsplash.com/photo-1580618864180-f6d7d39b8ff6?ixlib=rb-1.2.1&auto=format&fit=crop&w=1600&q=80" },
    { code: "barber-7", image: "https://images.unsplash.com/photo-1621605815972-f9e5c6c4a9c4?ixlib=rb-1.2.1&auto=format&fit=crop&w=1600&q=80" },
    { code: "barber-8", image: "https://images.unsplash.com/photo-1599351431202-1e0f0137899a?ixlib=rb-1.2.1&auto=format&fit=crop&w=1600&q=80" },
    { code: "barber-9", image: "https://images.unsplash.com/photo-1580618864180-f6d7d39b8ff6?ixlib=rb-1.2.1&auto=format&fit=crop&w=1600&q=80" }
];

// ========== SERVICES DATABASE ==========
const allServices = [
    // STANDARD SERVICES
    { name: 'Services & Pricing Display', tier: 'standard', description: 'Clear display of all services and prices' },
    { name: 'Barber Profiles / Team Section', tier: 'standard', description: 'Introduce your team with bios and photos' },
    { name: 'Photo Gallery / Portfolio', tier: 'standard', description: 'Showcase your work with high-quality images' },
    { name: 'Before & After Slider', tier: 'standard', description: 'Interactive before/after image comparison' },
    { name: 'Special Offers / Promotions Section', tier: 'standard', description: 'Display current deals and promotions' },
    { name: 'Location & Directions', tier: 'standard', description: 'Google Maps integration with directions' },
    { name: 'Tap-to-Call & WhatsApp Buttons', tier: 'standard', description: 'One-click calling and WhatsApp messaging' },
    { name: 'Opening Hours Display', tier: 'standard', description: 'Interactive hours with open/closed status' },
    { name: 'Membership / Loyalty Program Section', tier: 'standard', description: 'Display your loyalty program details' },
    { name: 'FAQ Section', tier: 'standard', description: 'Answers to common client questions' },
    // PREMIUM SERVICES
    { name: 'Online Booking System Embed', tier: 'premium', description: 'Calendly/Setmore integration for bookings' },
    { name: 'Stripe Payment / Deposit Integration', tier: 'premium', description: 'Secure online payments and deposits' },
    { name: 'Automated Booking Reminders', tier: 'premium', description: 'Email/SMS reminders via booking tool' },
    { name: 'Appointment Cancellation / Reschedule Info', tier: 'premium', description: 'Clear policies and rescheduling options' },
    { name: 'Gift Card / Voucher Section', tier: 'premium', description: 'Sell and manage digital gift cards' },
    { name: 'Kids / Senior / Special Service Tags', tier: 'premium', description: 'Highlight kids, seniors, specialty services' },
    { name: 'Walk-In / Waitlist Info Section', tier: 'premium', description: 'Real-time waitlist and walk-in updates' },
    { name: 'Barber Specialties Tags', tier: 'premium', description: 'Highlight specific skills and specialties' },
    { name: 'Prominent Call-to-Action Buttons', tier: 'premium', description: 'Strategic buttons to drive conversions' },
    { name: 'Enhanced Before & After Slider', tier: 'premium', description: 'Interactive slider with filtering options' }
];

// ========== FORM STATE ==========
let currentStep = 1;
const formData = {
    businessName: '',
    projectType: '',
    designConcept: '',
    designCode: '',
    features: [],
    audience: '',
    style: '',
    color: '',
    goal: '',
    urgency: '',
    planModel: '',
    planType: ''
};

let premiumServiceCount = 0;
let standardServiceCount = 0;
let recommendedPlan = { type: '', glow: false };

// DOM Elements
const screens = document.querySelectorAll('.form-screen');
const stepDots = document.querySelectorAll('.step-dot');
const businessInput = document.getElementById('businessInput');
const designCodeInput = document.getElementById('designCodeInput');
const codeStatus = document.getElementById('codeStatus');
const conceptDisplay = document.getElementById('conceptDisplay');
const conceptDisplayImage = document.getElementById('conceptDisplayImage');
const conceptDisplayCode = document.getElementById('conceptDisplayCode');
const confirmDesignBtn = document.getElementById('confirmDesignBtn');
const tryDifferentBtn = document.getElementById('tryDifferentBtn');

// ========== DESIGN CODE FUNCTIONS ==========
function normalizeCode(input) {
    if (!input) return '';
    let normalized = input.toLowerCase().trim().replace(/^barber[\s\-]*/i,'').replace(/[^0-9\-]/g,'');
    if (/^\d+$/.test(normalized)) return `barber-${normalized}`;
    if (normalized.includes('-')) {
        const num = normalized.split('-').pop();
        if (/^\d+$/.test(num)) return `barber-${num}`;
    }
    return '';
}

function findConceptByCode(input) {
    const normalizedCode = normalizeCode(input);
    if (!normalizedCode) return null;
    return barberConcepts.find(c => c.code === normalizedCode);
}

function validateAndDisplayConcept() {
    const input = designCodeInput.value.trim();
    if (!input) {
        codeStatus.textContent = '';
        codeStatus.className = 'code-status';
        conceptDisplay.style.display = 'none';
        tryDifferentBtn.style.display = 'none';
        return;
    }
    const concept = findConceptByCode(input);
    if (concept) {
        codeStatus.textContent = `✓ Valid code: ${concept.code}`;
        codeStatus.className = 'code-status success';
        conceptDisplayImage.src = concept.image;
        conceptDisplayImage.alt = `Design ${concept.code}`;
        conceptDisplayCode.textContent = concept.code.toUpperCase();
        conceptDisplay.style.display = 'block';
        confirmDesignBtn.innerHTML = `<i class="fas fa-check"></i> Continue with ${concept.code.toUpperCase()}`;
        tryDifferentBtn.style.display = 'inline-block';
    } else {
        codeStatus.textContent = `✗ Design not found. Try "barber-1" to "barber-${barberConcepts.length}"`;
        codeStatus.className = 'code-status error';
        conceptDisplay.style.display = 'none';
        tryDifferentBtn.style.display = 'none';
    }
}

function confirmDesignSelection() {
    const concept = findConceptByCode(designCodeInput.value.trim());
    if (concept) {
        formData.designCode = concept.code;
        formData.designConcept = 'From Code';
        updateHiddenFields();
        next();
    }
}

function tryDifferentCode() {
    designCodeInput.value = '';
    designCodeInput.focus();
    codeStatus.textContent = '';
    codeStatus.className = 'code-status';
    conceptDisplay.style.display = 'none';
    tryDifferentBtn.style.display = 'none';
}

// ========== SERVICE SELECTION ==========
function toggleService(serviceName, element) {
    const index = formData.features.indexOf(serviceName);
    if (index === -1) {
        formData.features.push(serviceName);
        element.classList.add('selected');
    } else {
        formData.features.splice(index,1);
        element.classList.remove('selected');
    }
    updateServiceCounters();
    calculateRecommendedPlan();
    showPlanRecommendation();
}

function updateServiceCounters() {
    standardServiceCount = 0;
    premiumServiceCount = 0;
    formData.features.forEach(f => {
        const s = allServices.find(s => s.name === f);
        if (!s) return;
        if (s.tier === 'standard') standardServiceCount++;
        if (s.tier === 'premium') premiumServiceCount++;
    });
    document.getElementById('standardCount').textContent = standardServiceCount;
    document.getElementById('premiumCount').textContent = premiumServiceCount;
    document.getElementById('totalCount').textContent = formData.features.length;

    const servicesList = document.getElementById('servicesList');
    servicesList.innerHTML = '';
    if (formData.features.length > 0) {
        document.getElementById('selectedServicesList').style.display = 'block';
        formData.features.forEach(f => {
            const serviceData = allServices.find(s => s.name === f);
            const badge = document.createElement('div');
            badge.style = `background:${serviceData.tier==='standard'?'#4CAF50':'#2196F3'};color:white;padding:0.3rem 0.8rem;border-radius:20px;font-size:0.8rem;display:flex;align-items:center;gap:5px;`;
            badge.innerHTML = `<span>${f}</span> <i class="fas fa-times" style="cursor:pointer;" onclick="removeService('${f}')"></i>`;
            servicesList.appendChild(badge);
        });
    } else {
        document.getElementById('selectedServicesList').style.display = 'none';
    }
}

function removeService(serviceName) {
    const index = formData.features.indexOf(serviceName);
    if (index !== -1) {
        formData.features.splice(index,1);
        document.querySelectorAll('.service-card').forEach(card => {
            const h4 = card.querySelector('h4');
            if(h4 && h4.textContent === serviceName) card.classList.remove('selected');
        });
        updateServiceCounters();
        calculateRecommendedPlan();
        showPlanRecommendation();
    }
}

function calculateRecommendedPlan() {
    if (premiumServiceCount >= 1) {
        recommendedPlan.type = 'Premium';
        recommendedPlan.glow = true;
    } else {
        recommendedPlan.type = 'Standard';
        recommendedPlan.glow = formData.features.length > 0;
    }
    return recommendedPlan;
}

function showPlanRecommendation() {
    const recommendation = calculateRecommendedPlan();
    const preview = document.getElementById('planRecommendationPreview');
    const logicInfo = document.getElementById('planLogicInfo');

    if (formData.features.length > 0) {
        logicInfo.style.display = 'block';
        if (recommendation.type==='Premium') {
            document.getElementById('planLogicText').textContent = `You selected ${premiumServiceCount} premium service(s) → Premium recommended`;
            preview.style.display='inline-block';
            preview.style.background='linear-gradient(90deg,#2196F3,#21CBF3)';
            document.getElementById('recommendedPlanPreview').textContent='Premium Plan';
        } else {
            document.getElementById('planLogicText').textContent = `No premium services selected → Standard recommended`;
            if (recommendation.glow) {
                preview.style.display='inline-block';
                preview.style.background='linear-gradient(90deg,#4CAF50,#66BB6A)';
                document.getElementById('recommendedPlanPreview').textContent='Standard Plan';
            } else preview.style.display='none';
        }
    } else {
        preview.style.display='none';
        logicInfo.style.display='none';
    }
}

function nextFromServices() {
    if (formData.features.length===0) return alert('Please select at least one service to continue.');
    formData.planType = recommendedPlan.type;
    localStorage.setItem('recommendedPlan', JSON.stringify(recommendedPlan));
    next();
}

// ========== FUNNEL NAVIGATION ==========
function showScreen(screenId) {
    screens.forEach(s=>s.classList.remove('active'));
    const screen = document.getElementById(screenId);
    if(screen){
        screen.classList.add('active');
        if(screenId==='step-9'){
            if(formData.businessName) document.getElementById('step9Title').innerHTML=`Select Services for <span style="color:#FF6B00;">${formData.businessName}</span>`;
            updateServiceCounters();
            showPlanRecommendation();
        }
        if(screenId==='step-13') showFinalPlans();
        if(screenId==='step-4'){
            setTimeout(()=>{
                designCodeInput.focus();
                if(formData.designCode){ designCodeInput.value=formData.designCode; validateAndDisplayConcept(); }
            },100);
        }
    }
}

function next(){ if(currentStep<13){ currentStep++; updateStepIndicator(); } }
function prev(){ if(currentStep>1){ currentStep--; updateStepIndicator(); } }

function updateStepIndicator(){
    stepDots.forEach((dot,i)=>dot.classList.toggle('active',i<currentStep));
    showScreen('step-'+currentStep);
    updateHiddenFields();
}

function updateHiddenFields(){
    document.getElementById('hiddenDesignCode').value=formData.designCode||'';
    document.getElementById('hiddenFeatures').value=formData.features.join(', ');
}

// ========== INITIALIZATION ==========
document.addEventListener('DOMContentLoaded',()=>{
    updateStepIndicator();
    if(currentStep===1 && businessInput) businessInput.focus();
    designCodeInput.addEventListener('input',validateAndDisplayConcept);
    designCodeInput.addEventListener('keypress',e=>{
        if(e.key==='Enter'){ const concept=findConceptByCode(designCodeInput.value.trim()); if(concept) confirmDesignSelection(); }
    });
    const mobileBtn=document.getElementById('mobileMenuBtn');
    if(mobileBtn) mobileBtn.addEventListener('click',()=>{ const nav=document.querySelector('.nav-links'); nav.style.display=(nav.style.display==='flex'?'none':'flex'); });
});
</script>

</body>
</html>
